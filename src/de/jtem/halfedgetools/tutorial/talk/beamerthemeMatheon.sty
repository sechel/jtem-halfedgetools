% Version: $Id: beamerthemeMatheon.sty,v 1.17 2007/07/06 15:33:59 bzfpfets Exp $
%
% LaTeX-beamer class beamerMatheon
%
% for the
%          DFG Research Center Matheon
%          Mathematics for Key Technologies
%
% Please send corrections and suggestions to webmaster@matheon.de
% ----------------------------------------------------------------------
%
% Version 1.1    06/2007 (Marc Pfetsch)
% - modified and corrected table of contents
%   (should now work with all beamer versions)
% - corrected bug in titlepage: the page numbers were set if it
%   was not generated by the \maketitle command. This should
%   be fixed now.
% - removed warning if size of \Matheon command is too small
%   Matheon is now typeset in lower case if fake small caps is unavailable
%
%
% Previous versions:
%
% - Version 1.0  02/2007 (Marc Pfetsch)
%   first version
%
% ----------------------------------------------------------------------
% The options for this class are:
% + language={german,english}  - select language
% ----------------------------------------------------------------------
% To create a titlepage do the following:
%
% - Insert information with the following commands:
%   + \title{}       define title
%   + \subtitle{}    define a subtitle
%   + \author{}      define author(s)
%   + \institute{}   define institution
%   + \jointwork{}   sets additional information
%   + \date{}        sets date (and place)
%
% With the command:
%   \footinformation{...}
% you can define a text that is typeset on every slide
% ----------------------------------------------------------------------
% To add logos to the titlepage (the appear inside the white bar) use
% one or more of the following commands (the order matters):
%   \insertLogoFU
%   \insertLogoHU
%   \insertLogoTU
%   \insertLogoWIAS
%   \insertLogoZIB
%
% To insert other logos use:
%   \pgfdeclareimage[height=1cm]{name}{filename}
%   \insertLogo{name}
%
% Please note:
% - "height" should be at most 1.25cm
% - "name" is an arbitrary name
% - the filename should not include extensions like ".png", ".pdf", ...
% ----------------------------------------------------------------------
%
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerthemeMatheon}

% we need the following two packages for typesetting Matheon (see below)
\RequirePackage{relsize}  % for 'fake' small-caps (see \Matheon)
\RequirePackage{xspace}   % should be loaded last

% default language is english
\def\matheon@language{english}

% default style is 'bar'-style
\def\matheon@style{bar}

% declare options:
\DeclareOptionBeamer{language}{\def\matheon@language{#1}}
\DeclareOptionBeamer{lineStyle}{\def\matheon@style{line}}

% parse options
\ProcessOptionsBeamer

% allowed languages:
\def\matheon@languageEnglish{english}
\def\matheon@languageGerman{german}

% check options
\ifx\matheon@language\matheon@languageEnglish%
\else%
\ifx\matheon@language\matheon@languageGerman%
\else%
\PackageError{beamerthemeMatheon}{Unkown language}{allowed values: "english", "german"}{}%
\fi%
\fi%

% ----------------------------------------------------------------------------------

% Redefine maketitle command:
\def\maketitle{%
  \ifbeamer@inframe%
  \PackageError{beamerthemeMatheon}{maketitle should be called outside a frame.}{}%
  \else%
  \frame[plain]{\titlepage}
  \fi%
}

% new command to typeset information on every slide
\newcommand{\insert@footinfo}{}
\newcommand{\footinformation}[1]{\renewcommand{\insert@footinfo}{#1}}

% new command to typeset joint work
\newcommand{\insert@jointwork}{}
\newcommand{\jointwork}[1]{\renewcommand{\insert@jointwork}{#1}}

% define for comparision for styles:
\def\matheon@styleBar{bar}
\def\matheon@styleLine{line}

%----------------------------------------------------------------------------------

% declare logos
\pgfdeclareimage[height=1cm]{TULogo}{tulogo}
\pgfdeclareimage[height=1.2cm]{FULogo}{fulogo}
\pgfdeclareimage[height=1.2cm]{HULogo}{hulogo}
\pgfdeclareimage[height=1cm]{WIASLogo}{wiaslogo}
\pgfdeclareimage[height=1.20cm]{ZIBLogoBlue}{ziblogo-blue}
\pgfdeclareimage[height=1.20cm]{ZIBLogoBlueVar}{ziblogo-blue-var}
\pgfdeclareimage[height=1.25cm]{ZIBLogoWhite}{ziblogo-white}

% define spacing between logos
\newdimen\beamerMatheonLogoSpacing
\beamerMatheonLogoSpacing=0mm

% temporary variable for computing the width of a logo
\newdimen\matheon@logoWidth

% command to set a logo (used by the titlepage)
\def\matheon@setLogo#1{%
  \settowidth{\matheon@logoWidth}{\hspace{\beamerMatheonLogoSpacing}\pgfuseimage{#1}}
  \begin{minipage}[b][1.25cm][c]{\matheon@logoWidth}%
    \hspace{\beamerMatheonLogoSpacing}\pgfuseimage{#1}%
  \end{minipage}%
}

% macro that stores the commands to set the logos on the titlepage
\def\matheon@insertLogos{}

% temporary register
\newtoks\matheon@tmp

% new macro for inserting a logo:
\def\insertLogo#1{%
  \matheon@tmp=\expandafter{\matheon@insertLogos}%
  \edef\matheon@insertLogos{\the\matheon@tmp\noexpand\matheon@setLogo{#1}}%
}
\def\insertLogoFU{\insertLogo{FULogo}}
\def\insertLogoHU{\insertLogo{HULogo}}
\def\insertLogoTU{\insertLogo{TULogo}}
\def\insertLogoWIAS{\insertLogo{WIASLogo}}
\def\insertLogoZIB{%
  \ifx\matheon@style\matheon@styleBar%
  \insertLogo{ZIBLogoBlue}%
  \else%
  \insertLogo{ZIBLogoBlueVar}%
  \fi%
}%

% ----------------------------------------------------------------------------------
% define Matheon command

% The sans serif fonts usually do not support small caps.  Therefore LaTeX
% usually replaces the corresponding font by the corresponding one in a
% roman font. We use the approach to 'fake' the small caps as follows:
%\newcommand{\Matheon}{M{\smaller ATHEON}\xspace}

% Extended version to avoid warnings if size is already too small
\newcommand{\Matheon}{M{%
\ifx\@currsize\tiny atheon\else\smaller ATHEON\fi}\xspace%
}

% The following would be cleaner if small caps would be supported:
%\newcommand{\Matheon}{\textsc{Matheon}\xspace}


% ----------------------------------------------------------------------------------
% declare other images
\pgfdeclareimage[height=0.7cm]{MatheonLogoImage}{matheon-logo}
\pgfdeclareimage[height=1.2cm]{MatheonLogoColorImage}{matheon-logo-color}
\pgfdeclareimage[width=3cm]{MatheonLogoImageBig}{matheon-logo}
\pgfdeclareimage[width=3cm]{MatheonLogoColorImageBig}{matheon-logo-color}


% ----------------------------------------------------------------------------------
% we only define the presentation part
\mode<presentation>

\usecolortheme{matheon}
\useinnertheme{default}
\useinnertheme{matheon}
\useoutertheme{default}
\useoutertheme{matheon}


% ----------------------------------------------------------------------
% ---------------------- Set Colors ------------------------------------
% ----------------------------------------------------------------------

% define basic blue depending on the style
\ifx\matheon@style\matheon@styleBar%
%\definecolor{matheonblue}{rgb}{0,0.45490196,0.60392157}%
\definecolor{matheonblue}{rgb}{0.15,0.35,0.65}
\else%
\definecolor{matheonblue}{rgb}{0,0,1.0}%
\fi%

% Set color of separating line (used by beameroutthemeMatheon)
\setbeamercolor{separation line}{fg=matheonblue,bg=black}

% Set color for text
\setbeamercolor*{normal text}{fg=black,bg=white}

% set colors for title and title page depending on the style settings
\ifx\matheon@style\matheon@styleBar%
\setbeamercolor{title page}{fg=white,bg=matheonblue}
\setbeamercolor{title}{fg=white,bg=matheonblue}
\setbeamercolor{frametitle}{fg=white,bg=matheonblue}%
\setbeamercolor{matheon footline}{fg=white,bg=matheonblue}%
\else%
\setbeamercolor{title page}{fg=matheonblue,bg=white}
\setbeamercolor{title}{fg=matheonblue,bg=white}
\setbeamercolor{frametitle}{fg=black,bg=white}%
\setbeamercolor{matheon footline}{fg=black,bg=white}%
\fi%


% ----------------------------------------------------------------------
% ---------------------- Set Fonts -------------------------------------
% ----------------------------------------------------------------------

\setbeamerfont{title}{series=\bfseries,size=\large,parent=structure}
\setbeamerfont{date}{size=\scriptsize,parent=structure}
\setbeamerfont{joint work}{size=\normalsize,parent=structure}
\setbeamerfont{page number in head/foot}{size=\tiny,parten=structure}
\setbeamerfont{information in head/foot}{size=\tiny,parten=structure}

% ----------------------------------------------------------------------
% ---------------------- Set Styles ------------------------------------
% ----------------------------------------------------------------------

\setlength{\leftmargini}{1.1em}
\setlength{\leftmarginii}{1em}
\setlength{\leftmarginiii}{0.9em}
\setlength{\leftmarginiv}{0.9em}
\setlength{\labelsep}{.5em}

% ----------------------------------------------------------------------
% ---------------------- Define New Titlepage --------------------------
% ----------------------------------------------------------------------

% Note: we do not allow a titlegraphic
\defbeamertemplate{title page}{matheon bar}{%
  % make sure that pagestyle is empty [if the title page is accidently
  % called in a frame and not by \maketile this is needed.]
  \thispagestyle{empty}
  % put everything in a large box with the corresponding colors
  \begin{beamercolorbox}[wd=\paperwidth,dp=0pt,ht=\paperheight,sep=0pt,colsep=0pt,colsep*=0pt]{title page}%
    \centering%
    % to get correct spacing (e.g. \textwidth) put everything in a minipage
    \begin{minipage}[b][0.85\textheight][b]{\textwidth}
      % set matheon logo
      \begin{minipage}[b][3cm][c]{3cm}
        \pgfuseimage{MatheonLogoImageBig}
      \end{minipage}
      \hfill
      % set title and subtitle
      \newdimen\my@tempDim%
      \my@tempDim=\textwidth%
      \advance\my@tempDim by -3.5cm%
      \begin{minipage}[b][3cm][c]{\my@tempDim}
       \raggedleft
       \usebeamerfont{title}\inserttitle\par%
       \ifx\insertsubtitle\@empty%
       \else%
       \vskip0.25em%
       {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
       \fi%
      \end{minipage}
      \vskip1em\par
      % set author
      \begin{beamercolorbox}[sep=0pt,right]{author}
        \usebeamerfont{author}\insertauthor
      \end{beamercolorbox}
      % set institute
      \begin{beamercolorbox}[sep=0pt,right]{institute}
        \usebeamerfont{institute}\insertinstitute
      \end{beamercolorbox}\vskip1em\par
      % set joint work
      \begin{beamercolorbox}[sep=0pt,right]{joint work}
        \usebeamerfont{joint work}\insert@jointwork
      \end{beamercolorbox}
    \end{minipage}
    \vspace{2ex}

    % set white bar accross the page (need minipage around and inside the beamercolorbox)
    \begin{minipage}[b][1.25cm][b]{\paperwidth}
      \begin{beamercolorbox}[sep=0pt,wd=\paperwidth,dp=0pt,ht=1.25cm,colsep=0pt,colsep*=0pt,left]{normal text}
        \begin{minipage}[b][1.25cm][b]{\paperwidth}
          % set Matheon text
          \hspace*{1.75ex}%
          \begin{minipage}[b][1.25cm][c]{6.2cm}%
            \raggedright\footnotesize\bf%
            \textcolor{matheonblue}{%
              \ifx\matheon@language\matheon@languageEnglish%
              DFG Research Center \Matheon\\
              \textit{Mathematics for key technologies}
              \else%
              \ifx\matheon@language\matheon@languageGerman%
              DFG-Forschungszentrum \Matheon\\
              \textit{Mathematik f\"ur Schl\"usseltechnologien}
              \fi%
              \fi%
            }%
          \end{minipage}%
          % set logos (if present)
          \hfill\matheon@insertLogos\hspace*{2ex}
        \end{minipage}
      \end{beamercolorbox}
    \end{minipage}
    % set date (and place)
    \begin{beamercolorbox}[sep=0pt,left]{date}%
      \usebeamerfont{date}\insertdate
    \end{beamercolorbox}
    % to move minipage to correct position (a bit ugly)
    \vspace{1ex}
  \end{beamercolorbox}%
}


% Note: we do not allow a titlegraphic
\defbeamertemplate{title page}{matheon line}{%
  % make sure that pagestyle is empty [if the title page is accidently
  % called in a frame and not by \maketile this is needed.]
  \thispagestyle{empty}
  % put everything in a large box with the corresponding colors
  \begin{beamercolorbox}[wd=\paperwidth,dp=0pt,ht=\paperheight,sep=0pt,colsep=0pt,colsep*=0pt]{title page}%
    \centering%
    % to get correct spacing (e.g. \textwidth) put everything in a minipage
    \begin{minipage}[b][0.85\textheight][b]{\textwidth}
      % set matheon logo
      \begin{minipage}[b][3cm][c]{3cm}
        \pgfuseimage{MatheonLogoColorImageBig}
      \end{minipage}
      \hfill
      % set title and subtitle
      \newdimen\my@tempDim%
      \my@tempDim=\textwidth%
      \advance\my@tempDim by -3.5cm%
      \begin{minipage}[b][3cm][c]{\my@tempDim}
        \raggedleft
        \usebeamerfont{title}\inserttitle\par%
        \ifx\insertsubtitle\@empty%
        \else%
        \vskip0.25em%
        {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
        \fi%
      \end{minipage}
      \vskip1em\par
      % set author
      \begin{beamercolorbox}[sep=0pt,right]{author}
        \usebeamerfont{author}\insertauthor
      \end{beamercolorbox}
      % set institute
      \begin{beamercolorbox}[sep=0pt,right]{institute}
        \usebeamerfont{institute}\insertinstitute
      \end{beamercolorbox}%
      \vskip1em\par
      % set joint work
      \begin{beamercolorbox}[sep=0pt,right]{joint work}
        \usebeamerfont{joint work}\insert@jointwork
      \end{beamercolorbox}
      \vfill\par
      % set logos (if present)
      \begin{beamercolorbox}[sep=0pt,right]{title page}
        \begin{minipage}[b][1.25cm][b]{\textwidth}
          % set Matheon text
          \begin{minipage}[b][1.25cm][c]{6cm}%
            \raggedright\footnotesize\bf%
            \textcolor{matheonblue}{%
              \ifx\matheon@language\matheon@languageEnglish%
              DFG Research Center \Matheon\\
              \textit{Mathematics for key technologies}
              \else%
              \ifx\matheon@language\matheon@languageGerman%
              DFG-Forschungszentrum \Matheon\\
              \textit{Mathematik f\"ur Schl\"usseltechnolgien}
              \fi%
              \fi%
            }%
          \end{minipage}%
          % set logos (if present)
          \hfill\matheon@insertLogos
        \end{minipage}
      \end{beamercolorbox}
      % add rule
      \vskip-2ex
      \hbox{\usebeamercolor[fg]{separation line}\rule[0ex]{0.941\paperwidth}{.03cm}}%
      % set date (and place)
      \begin{beamercolorbox}[sep=0pt,left]{date}
        \usebeamerfont{date}\insertdate
      \end{beamercolorbox}
    \end{minipage}
    % to move minipage to correct position (a bit ugly)
    \vspace{1ex}
  \end{beamercolorbox}%
}


% set title depending on the style
\ifx\matheon@style\matheon@styleBar%
\setbeamertemplate{title page}[matheon bar]%
\else%
\setbeamertemplate{title page}[matheon line]%
\fi%



% ----------------------------------------------------------------------
% ---------------------- Define New Titlepage --------------------------
% ----------------------------------------------------------------------

% set frametitles depending on the style
\ifx\matheon@style\matheon@styleBar%
\setbeamertemplate{frametitle}[matheon bar frametitle]%
\setbeamertemplate{footline}[matheon bar footline]%
\else%
\setbeamertemplate{frametitle}[matheon line frametitle]%
\setbeamertemplate{footline}[matheon line footline]%
\fi%

% choose ball style for table of contents:
% sections get numbers in balls, subsections only balls
\setbeamertemplate{sections/subsections in toc}[ball]
\setbeamertemplate{subsection in toc}[ball]

% set margins
\setbeamersize{text margin left=2ex}
\setbeamersize{text margin right=2ex}

\mode
<all>
